/*
 * Copyright 2010-2013 icl-network.com. All rights reserved.
 * Support: http://www.icl-network.com
 *
 * JavaScript - Borrowing Apply
 * Version: 3.0
 */
$().ready(function() {
    
		var $inputForm = $("#inputForm");
	$inputForm.find(":submit").prop("disabled", false);
	var $validate = $inputForm.validate({
		rules: {
			borrower: "required",
			type: "required",
			title: "required",
			amount: {
				required: true,
				positive: true,
				decimal: {
					integer: 12,
					fraction: 2
				}
			},
			period: {
				required: true,
				integer: true,
				min: 1
			},
			interestRate: {
				required: true,
				positive: true,
				decimal: {
					integer: 2,
					fraction: 2
				}
			},
			description: "required",
			purpose: "required",
			repaymentInquiry: "required",
			guaranteeCapital: {
				required: true,
				number: true,
				min: 0,
				decimal: {
					integer: 12,
					fraction: 2
				}
			},
			riskAnalysis: "required",
			riskDegree: {
				required: true,
				number: true,
				min: 0,
				decimal: {
					integer: 2,
					fraction: 2
				}
			},
			creditRating: "required",
			investmentMethod: "required",
			investmentMinimum: {
				required: true,
				positive: true,
				decimal: {
					integer: 12,
					fraction: 2
				}
			},
			investmentMaximum: {
				number: true,
				min: 0,
				decimal: {
					integer: 12,
					fraction: 2
				}
			},
			investmentPeriod: {
				digits: true
			},
			lendingTime: "required",
			repaymentMethod: "required",
			prepaymentDefaultPeriod: {
				required: true,
				digits: true
			},
			prepaymentFeeRate: {
				required: true,
				number: true,
				min: 0,
				decimal: {
					integer: 2,
					fraction: 2
				}
			},
			feeRate: {
				required: true,
				number: true,
				min: 0,
				decimal: {
					integer: 2,
					fraction: 2
				}
			},
			repaymentFeeRate: {
				required: true,
				number: true,
				min: 0,
				decimal: {
					integer: 2,
					fraction: 2
				}
			},
			recoveryFeeRate: {
				required: true,
				number: true,
				min: 0,
				decimal: {
					integer: 2,
					fraction: 2
				}
			},
			overdueInterestRate: {
				required: true,
				number: true,
				min: 0,
				decimal: {
					integer: 2,
					fraction: 2
				}
			},
			overdueFeeRate: {
				required: true,
				number: true,
				min: 0,
				decimal: {
					integer: 2,
					fraction: 2
				}
			},
			seriousOverdueStartPeriod: {
				required: true,
				digits: true
			},
			seriousOverdueInterestRate: {
				required: true,
				number: true,
				min: 0,
				decimal: {
					integer: 2,
					fraction: 2
				}
			},
			seriousOverdueFeeRate: {
				required: true,
				number: true,
				min: 0,
				decimal: {
					integer: 2,
					fraction: 2
				}
			},
			inquired: "required",
			opinion: "required"
		}
	});
	
	var $chosenSelect = $(".chosen-select");
	$chosenSelect.change(function() {
		$validate.element(this);
	});
	
	var $datetimepicker = $(".datetimepicker");
	$datetimepicker.change(function() {
		$validate.element(this);
	});
	
var $materialTable = $("#materialTable tbody");
var materialIndex = 0;

$("#addMaterial").click(function() {
$materialTable.append(" <tr> <td> <div class=\"input-group input-file\"> <input class=\"form-control file-name ignore\" /> <span class=\"input-group-btn\"> <span class=\"btn btn-default btn-file\"> 选择图片 <input type=\"file\" name=\"materials[" + materialIndex + "].file\" /> </span> </span> </div> </td> <td> <input class=\"form-control\" type=\"text\" name=\"materials[" + materialIndex + "].title\" /> </td> <td> <input class=\"form-control\" type=\"text\" name=\"materials[" + materialIndex + "].order\" /> </td> <td> <a href=\"#\" class=\"delete\"> <i class=\"icon-remove\"></i> 删除 </a> </td> </tr> ");	materialIndex++;
});

$materialTable.on("click", "a.delete", function(e) {
	e.preventDefault();
	
	var $this = $(this);
	$this.closest("tr").remove();
});	
});